<div class="Product-box sm-margin-top-96px xs-margin-top-0">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-md-5 col-sm-6">
                <div class="advance-product-box">
                    <ul class="products biolife-carousel nav-top-right nav-none-on-mobile" data-slick='{"arrows":true, "dots":false, "infinite":false, "speed":400, "slidesMargin":30, "slidesToShow":1}'>
                        @if (products != null && products.Any())
                        {
                            @foreach (var item in products)
                            {

                                @if (item.Discount > 0)
                                {
                                    <li class="product-item">
                                        <div class="contain-product deal-layout contain-product__deal-layout">
                                            <div class="product-thumb">
                                                <a onclick="window.location.href='/san-pham/@item.NameSlug/@item.Id';" class="link-to-product">
                                                    <img src="@(string.IsNullOrEmpty(item.ImageFilePath) ? "/Img_Dev/banner.png" : item.ImageFilePath)" alt="dd" width="330" height="330" class="product-thumnail">
                                                </a>
                                                <div class="labels">
                                                    <span class="sale-label">Giảm giá</span>
                                                </div>
                                            </div>
                                            <div class="info">
                                                <div class="biolife-countdown" data-datetime="@item.CreatedAt.ToString("dd-MM-yyyy")"></div>
                                                <b class="categories">@item.CategoryName</b>
                                                <h4 class="product-title"><a href="#" class="pr-name">@item.Name</a></h4>
                                                <div class="price ">
                                                    <ins><span class="price-amount"><span class="currencySymbol"></span>@((item.Price - item.Discount).ToString("N0")) đ</span></ins>
                                                    <del><span class="price-amount"><span class="currencySymbol"></span>@item.Discount.ToString("N0") đ</span></del>
                                                </div>
                                                <div class="slide-down-box">
                                                    <div class="buttons">
                                                        <a onclick="window.location.href='/san-pham/@item.NameSlug/@item.Id';" class="btn add-to-cart-btn">Xem thêm</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                }
                            }
                        }
                    </ul>
                </div>
            </div>
            <div class="col-lg-8 col-md-7 col-sm-6">
                <div class="advance-product-box">
                    <div class="biolife-title-box bold-style biolife-title-box__bold-style">
                        <h3 class="title">Sản phẩm giảm giá</h3>
                    </div>
                    <ul class="products biolife-carousel eq-height-contain nav-center-03 nav-none-on-mobile row-space-29px" data-slick='{"rows":2,"arrows":true,"dots":false,"infinite":false,"speed":400,"slidesMargin":30,"slidesToShow":2,"responsive":[{"breakpoint":1200,"settings":{ "rows":2, "slidesToShow": 2}},{"breakpoint":992, "settings":{ "rows":2, "slidesToShow": 1}},{"breakpoint":768, "settings":{ "rows":2, "slidesToShow": 2}},{"breakpoint":500, "settings":{ "rows":2, "slidesToShow": 1}}]}'>
                        @if(products != null && products.Any())
                        {
                            @foreach (var item in products)
                            {
                                <li class="product-item">
                                    <div class="contain-product right-info-layout contain-product__right-info-layout">
                                        <div class="product-thumb">
                                            <a onclick="window.location.href='/san-pham/@item.NameSlug/@item.Id';" class="link-to-product">
                                                <img src="@(string.IsNullOrEmpty(item.ImageFilePath) ? "/Img_Dev/banner.png" : item.ImageFilePath)" alt="dd" width="270" height="270" class="product-thumnail">
                                            </a>
                                        </div>
                                        <div class="info">
                                            <b class="categories">Vegetables</b>
                                            <h4 class="product-title"><a onclick="window.location.href='/san-pham/@item.NameSlug/@item.Id';" class="pr-name">Pumpkins Fairytale</a></h4>
                                            <div class="price ">
                                                <ins><span class="price-amount"><span class="currencySymbol"></span>@((item.Price - item.Discount).ToString("N0")) đ</span></ins>
                                                <del><span class="price-amount"><span class="currencySymbol"></span>@item.Discount.ToString("N0") đ</span></del>
                                            </div>
                                            <div class="rating">
                                                <p class="star-rating"><span class="width-80percent"></span></p>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            }
                        }
                       
                    </ul>
                    <div class="biolife-banner style-01 biolife-banner__style-01 xs-margin-top-80px-im sm-margin-top-30px-im">
                        <div class="banner-contain">
                            <a href="#" class="bn-link"></a>
                            <div class="text-content">
                                @*   <span class="first-line">Daily Fresh</span>
                                <b class="second-line">Natural</b>
                                <i class="third-line">Fresh Food</i>
                                <span class="fourth-line">Premium Quality</span> *@
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Block 07: Brands-->
<div class="brand-slide sm-margin-top-100px background-fafafa xs-margin-top-80px xs-margin-bottom-80px">
    <div class="container">
        <ul class="biolife-carousel nav-center-bold nav-none-on-mobile" data-slick='{"rows":1,"arrows":true,"dots":false,"infinite":false,"speed":400,"slidesMargin":30,"slidesToShow":4, "responsive":[{"breakpoint":1200, "settings":{ "slidesToShow": 4}},{"breakpoint":992, "settings":{ "slidesToShow": 3}},{"breakpoint":768, "settings":{ "slidesToShow": 2, "slidesMargin":10}},{"breakpoint":450, "settings":{ "slidesToShow": 1, "slidesMargin":10}}]}'>
            <li>
                <div class="biolife-brd-container">
                    <a href="#" class="link">
                        <figure><img src="assets/images/home-03/brd-01.jpg" width="214" height="163" alt=""></figure>
                    </a>
                </div>
            </li>
            <li>
                <div class="biolife-brd-container">
                    <a href="#" class="link">
                        <figure><img src="assets/images/home-03/brd-02.jpg" width="214" height="163" alt=""></figure>
                    </a>
                </div>
            </li>
            <li>
                <div class="biolife-brd-container">
                    <a href="#" class="link">
                        <figure><img src="assets/images/home-03/brd-03.jpg" width="153" height="163" alt=""></figure>
                    </a>
                </div>
            </li>
            <li>
                <div class="biolife-brd-container">
                    <a href="#" class="link">
                        <figure><img src="assets/images/home-03/brd-04.jpg" width="224" height="163" alt=""></figure>
                    </a>
                </div>
            </li>
            <li>
                <div class="biolife-brd-container">
                    <a href="#" class="link">
                        <figure><img src="assets/images/home-03/brd-01.jpg" width="214" height="163" alt=""></figure>
                    </a>
                </div>
            </li>
            <li>
                <div class="biolife-brd-container">
                    <a href="#" class="link">
                        <figure><img src="assets/images/home-03/brd-02.jpg" width="214" height="163" alt=""></figure>
                    </a>
                </div>
            </li>
            <li>
                <div class="biolife-brd-container">
                    <a href="#" class="link">
                        <figure><img src="assets/images/home-03/brd-03.jpg" width="153" height="163" alt=""></figure>
                    </a>
                </div>
            </li>
            <li>
                <div class="biolife-brd-container">
                    <a href="#" class="link">
                        <figure><img src="assets/images/home-03/brd-04.jpg" width="224" height="163" alt=""></figure>
                    </a>
                </div>
            </li>
        </ul>
    </div>
</div>

@code {
    private IEnumerable<ProductDto> products;
    private int currentPage = 1;
    private int pageSize = 9;
    private int totalPages;
    private int totalCount;
    private int? type;

    private Guid? categoryId = null;
    private decimal? minPrice = null;
    private decimal? maxPrice = null;
    private string? keyword = null;

    protected override async Task OnInitializedAsync()
    {
        await LoadListProducts();
    }

    private async Task LoadListProducts()
    {
        var response = await _productServices.GetListProductAsync(currentPage, pageSize, minPrice, maxPrice, categoryId, keyword, type);
        if (response != null && response.Success)
        {
            products = response.Data.Products;
        }
        else
        {
            products = new List<ProductDto>();
        }
    }
}